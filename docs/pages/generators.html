<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Generators - Clay Documentation</title>
    <link rel="stylesheet" href="../css/terminal.css" />
    <link rel="stylesheet" href="../css/docs.css" />
  </head>
  <body>
    <div class="doc-container">
      <a href="../index.html" class="back-home">‚Üê Back to Home</a>

      <div class="doc-header">
        <div class="breadcrumb">
          <a href="../index.html">Home</a>
          <span>‚Ä∫</span>
          <span>Generators</span>
        </div>
        <h1>Generators</h1>
        <div class="subtitle">Configure code generation steps</div>
      </div>

      <div class="doc-content">
        <h2>What are Generators?</h2>
        <p>
          Generators define a sequence of steps that transform your model into
          code. Each generator contains templates, partials, and configuration
          that tells Clay exactly what to generate.
        </p>

        <h2>Generator Structure</h2>
        <pre><code>{
  "partials": ["partials/header.hbs"],
  "steps": [
    {
      "generate": "templates/model.js",
      "select": "$.model.types[*]",
      "target": "src/models/{{kebabCase name}}.js"
    }
  ],
  "formatters": ["clay-generator-formatter-prettier"]
}</code></pre>

        <h2>Generator Properties</h2>

        <h3>partials</h3>
        <p>Array of Handlebars partial files to include:</p>
        <pre><code>"partials": [
  "partials/header.hbs",
  "partials/footer.hbs"
]</code></pre>

        <h3>steps</h3>
        <p>Array of generation steps (run in order):</p>
        <pre><code>"steps": [
  { "runCommand": "mkdir -p src/models" },
  { "generate": "templates/model.js", "select": "$.model.types[*]" },
  { "copy": "foundation", "target": "src/foundation" }
]</code></pre>

        <h3>formatters</h3>
        <p>Optional formatters to prettify generated code:</p>
        <pre><code>"formatters": ["clay-generator-formatter-prettier"]</code></pre>

        <h2>Step Types</h2>

        <h3>1. Generate (Template)</h3>
        <p>Generate files from Handlebars templates:</p>
        <pre><code>{
  "generate": "templates/model.js",
  "select": "$.model.types[*]",
  "target": "src/models/{{kebabCase name}}.model.js",
  "touch": false
}</code></pre>

        <p><strong>Parameters:</strong></p>
        <ul>
          <li><code>generate</code> - Path to template file</li>
          <li><code>select</code> - JSONPath to select data (optional)</li>
          <li><code>target</code> - Output path (can use Handlebars)</li>
          <li>
            <code>touch</code> - If true, only generate if file doesn't exist
          </li>
        </ul>

        <h3>2. Copy</h3>
        <p>Copy files or directories:</p>
        <pre><code>{
  "copy": "foundation",
  "select": "$.model.types[*]",
  "target": "src/{{kebabCase name}}/foundation"
}</code></pre>

        <p><strong>Parameters:</strong></p>
        <ul>
          <li>
            <code>copy</code> - Source path or git repo (e.g., "git+user/repo")
          </li>
          <li><code>select</code> - JSONPath to iterate (optional)</li>
          <li><code>target</code> - Destination path (can use Handlebars)</li>
        </ul>

        <h3>3. Run Command</h3>
        <p>Execute shell commands:</p>
        <pre><code>{
  "runCommand": "npm install",
  "npxCommand": false
}</code></pre>

        <p>With model data:</p>
        <pre><code>{
  "runCommand": "echo Generating {{name}}",
  "select": "$.model.types[*]"
}</code></pre>

        <p><strong>Parameters:</strong></p>
        <ul>
          <li><code>runCommand</code> - Shell command to execute</li>
          <li><code>npxCommand</code> - If true, run with npx</li>
          <li><code>select</code> - JSONPath to iterate (optional)</li>
        </ul>

        <h2>Complete Example</h2>
        <pre><code>{
  "partials": [
    "partials/license-header.hbs",
    "partials/imports.hbs"
  ],
  "steps": [
    {
      "runCommand": "mkdir -p src/models src/controllers src/routes"
    },
    {
      "generate": "templates/model.js",
      "select": "$.model.types[*]",
      "target": "src/models/{{kebabCase name}}.model.js"
    },
    {
      "generate": "templates/controller.js",
      "select": "$.model.types[*]",
      "target": "src/controllers/{{kebabCase name}}.controller.js"
    },
    {
      "generate": "templates/routes.js",
      "select": "$.model.types[*]",
      "target": "src/routes/{{kebabCase name}}.routes.js"
    },
    {
      "generate": "templates/index.js",
      "target": "src/index.js",
      "touch": true
    },
    {
      "copy": "config",
      "target": "config"
    },
    {
      "runCommand": "npm install"
    }
  ],
  "formatters": ["clay-generator-formatter-prettier"]
}</code></pre>

        <h2>Creating a Generator</h2>

        <h3>Initialize</h3>
        <pre><code>clay init generator my-generator</code></pre>

        <p>This creates:</p>
        <pre><code>clay/generators/my-generator/
‚îú‚îÄ‚îÄ generator.json
‚îî‚îÄ‚îÄ templates/</code></pre>

        <h3>Directory Structure</h3>
        <pre><code>clay/generators/api/
‚îú‚îÄ‚îÄ generator.json          # Configuration
‚îú‚îÄ‚îÄ templates/              # Handlebars templates
‚îÇ   ‚îú‚îÄ‚îÄ model.js
‚îÇ   ‚îú‚îÄ‚îÄ controller.js
‚îÇ   ‚îî‚îÄ‚îÄ routes.js
‚îú‚îÄ‚îÄ partials/              # Reusable template parts
‚îÇ   ‚îú‚îÄ‚îÄ header.hbs
‚îÇ   ‚îî‚îÄ‚îÄ imports.hbs
‚îî‚îÄ‚îÄ foundation/            # Files to copy
    ‚îî‚îÄ‚îÄ config.js</code></pre>

        <h2>Best Practices</h2>
        <ul>
          <li>Order steps logically (create directories before files)</li>
          <li>Use <code>select</code> to iterate over model arrays</li>
          <li>Use <code>touch: true</code> for files users might customize</li>
          <li>Test JSONPath selectors with <code>clay test-path</code></li>
          <li>Use partials for license headers, imports, etc.</li>
          <li>Add formatters for consistent code style</li>
          <li>Keep templates focused on single responsibilities</li>
        </ul>

        <h2>Getting Generators</h2>
        <p>
          Clay uses a <strong>local-first approach</strong>. All generators are
          stored in your project's <code>clay/generators/</code> directory.
        </p>

        <h3>Create a New Generator</h3>
        <p>Start from scratch with a template:</p>
        <pre><code>clay init generator my-api-generator</code></pre>

        <h3>Copy from a Local Path</h3>
        <p>
          Copy a generator from another location on your machine:
        </p>
        <pre><code>clay generator add /path/to/my-generator
clay generator add ../other-project/generators/my-generator</code></pre>

        <h3>Clone from the Registry</h3>
        <p>
          Browse available generators and clone them to your project:
        </p>
        <pre><code>clay generator list-available
clay generator add clay-model-documentation</code></pre>

        <h3>Clone from GitHub</h3>
        <p>
          Clone any generator repository. It will be copied to your local
          <code>clay/generators/</code> directory:
        </p>
        <pre><code>clay generator add https://github.com/user/my-generator</code></pre>

        <h3>Reference in Your Model</h3>
        <p>
          Generators are referenced by their path to the generator.json file:
        </p>
        <pre><code>{
  "name": "my-app",
  "generators": [
    "generators/my-api-generator/generator.json",
    "generators/forms/generator.json"
  ],
  "model": {...}
}</code></pre>

        <div class="note">
          <strong>üí° Pro Tip:</strong> After adding a generator, customize it
          for your project! The generator files are in
          <code>clay/generators/</code> and are part of your codebase. Use
          <code>clay watch</code> to see changes immediately!
        </div>

        <h2>Sharing Generators</h2>
        <p>
          Since generators are stored locally in your project, sharing them is
          easy:
        </p>
        <ul>
          <li>
            <strong>Commit to version control</strong> - Your
            <code>clay/generators/</code> directory is part of your project
          </li>
          <li>
            <strong>Copy between projects</strong> - Simply copy the generator
            directory
          </li>
          <li>
            <strong>Share via GitHub</strong> - Create a repo with your
            generator and others can clone it
          </li>
          <li>
            <strong>Add to the registry</strong> - Submit a PR to add your
            generator to the discovery registry
          </li>
        </ul>
          <div class="nav-title">Templates</div>
        </a>
      </div>
    </div>

    <script src="../js/terminal.js"></script>
  </body>
</html>
